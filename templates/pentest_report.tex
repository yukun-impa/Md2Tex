\documentclass[11pt,a4paper]{scrartcl}

% --- PACKAGES ---
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[english]{babel}

\usepackage{geometry}
\geometry{a4paper, top=3cm, bottom=3cm, left=2.5cm, right=2.5cm}

\usepackage{xcolor}
\definecolor{primary}{HTML}{2E86C1} % A nice blue
\definecolor{secondary}{HTML}{5D6D7E}
\definecolor{codebackground}{RGB}{245,245,245} % Light grey for code background

\usepackage{titlesec}
\titleformat{\section}{\Large\bfseries\color{primary}}}{\thesection}{1em}{}
\titleformat{\subsection}{\large\bfseries\color{secondary}}}{\thesubsection}{1em}{}
\titleformat{\subsubsection}{\bfseries}{\thesubsubsection}{1em}{}

\usepackage{graphicx}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=primary,
    urlcolor=primary,
    citecolor=primary
}

\usepackage{amsmath, amssymb, amsfonts}
\usepackage{ulem} % For strikethrough
\usepackage{fancyhdr} % For custom headers/footers
\usepackage{listings} % For code blocks
\usepackage{enumitem} % For better list control
\usepackage{xurl} % For better URL line breaking

% --- CUSTOM COMMANDS FOR REPORT METADATA ---
\newcommand{\reporttitle}{((TITLE))}
\newcommand{\reportauthor}{((AUTHOR))}
\newcommand{\reportclient}{} % Client Name
\newcommand{\reportversion}{1.0} % Report Version
\newcommand{\assessmentdate}{\today} % Date of Assessment

% --- LISTINGS (CODE BLOCKS) SETUP ---
\lstset{
    backgroundcolor=\color{codebackground},
    basicstyle=\small\ttfamily,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    commentstyle=\color{gray},
    extendedchars=true,
    frame=single,
    frameshape={}{}{}{}, % No frame on top/bottom, only left/right
    frameround=tttt, % Rounded corners
    keepspaces=true,
    keywordstyle=\color{blue},
    numbers=left,
    numbersep=5pt,
    numberstyle=\tiny\color{gray},
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    stringstyle=\color{red},
    tabsize=2,
    title=\lstname,
    xleftmargin=1em, % Indent from left margin
    xrightmargin=1em, % Indent from right margin
    aboveskip=1em,
    belowskip=1em,
}

% --- HEADERS AND FOOTERS ---
\pagestyle{fancy}
\fancyhf{} % Clear all headers and footers
\fancyhead[L]{\reportclient\ Report} % Left header: Client Name Report
\fancyhead[R]{Confidential} % Right header: Confidential
\fancyfoot[L]{\reporttitle} % Left footer: Report Title
\fancyfoot[R]{Page \thepage} % Right footer: Page Number
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

% --- CUSTOM TITLE PAGE ---
\pretitle{\begin{flushleft}\Huge\bfseries\color{primary}}
\posttitle{\par\end{flushleft}\vskip 0.5em}
\preauthor{\begin{flushleft}\large\bfseries\color{secondary}}
\postauthor{\par\end{flushleft}\vskip 1em}
\predate{\begin{flushleft}\small\itshape}
\postdate{\par\end{flushleft}}

\title{\reporttitle}
\author{\reportauthor}
\date{\assessmentdate}

% --- DOCUMENT ---
\begin{document}

\begin{titlepage}
    \centering
    % \includegraphics[width=0.4\textwidth]{path/to/your/company_logo.png}\\[1cm] % Placeholder for company logo
    \vspace*{2cm}
    {\Huge\bfseries\color{primary} \reporttitle\par}
    \vspace{1.5cm}
    {\Large\bfseries\reportauthor\par}
    \vspace{0.5cm}
    {\large\reportclient\par}
    \vspace{0.5cm}
    {\normalsize\assessmentdate\par}
    \vspace{0.2cm}
    {\normalsize Version: \reportversion\par}
    \vfill
    {\Large\bfseries\color{secondary} Penetration Test Report\par}
    \vspace{2cm}
    \hrule
    \vspace{0.5cm}
    \begin{minipage}{0.8\textwidth}
        \small
        \textbf{Confidentiality Statement:}\\
        This document contains confidential and proprietary information. It is intended solely for the use of the individual or entity to whom it is addressed. Any unauthorized disclosure, reproduction, or distribution is strictly prohibited.
    \end{minipage}
    \vspace{0.5cm}
    \hrule
\end{titlepage}

\clearpage
\thispagestyle{empty} % No header/footer on this page for the abstract placeholder
\section*{\centering Executive Summary}
\addcontentsline{toc}{section}{Executive Summary} % Manually add to TOC

% Placeholder for the Executive Summary content.
% This should be extracted from 00_Executive_Summary.md and inserted here by the converter.
% For now, a brief placeholder:
\vspace{1cm}
\noindent This report details the findings and recommendations from a penetration test conducted on \reportclient's systems. The assessment aimed to identify vulnerabilities and assess the overall security posture. Key findings, their impact, and prioritized recommendations are presented herein.
\clearpage

\tableofcontents

\clearpage

((CONTENT_FILES))

\end{document}